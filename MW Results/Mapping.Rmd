---
title: "Mapping"
author: "Matthew Warham"
date: "5/10/2019"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```


```{r mapping}

##EEZ boundaries


library(tidyverse)
library(sf)
library(tmap)
library(leaflet)
library(ggrepel)
library(ggspatial)
library(RColorBrewer)
library(raster)
library(tidyverse)
library(sf)
library(leaflet)




```

```{r maps}




data(EEZ_map)
#r <- rasterize(EEZ_map, raster())


# China as a test plot
china <- EEZ_final_results %>%
  dplyr::filter(flag == "CHN")


## check naming conventions of columns, changed from earlier today
eez_filtered_CHN <- EEZ_map %>%
  dplyr::filter(ez_hs_c %in% china$eez_iso3)

EEZ_final_results_CHN <- EEZ_final_results%>% 
  filter(flag == "CHN") 
  #filter(eez_iso3 == "USA", flag == "CHN") %>% 

plot_map_CHN <- ggplot()+
  geom_sf(data = EEZ_map, fill = "white", alpha = 0.5)+
  geom_sf(data = country_map, fill = "white")+
  geom_sf(data = country_map %>% dplyr::filter(iso3 == "CHN"), fill = "red") +
  geom_sf(data = eez_filtered_CHN , fill = "blue", alpha = 0.5) +
  geom_sf(data = EEZ_final_results_CHN, col = "darkorange", alpha = 0.2) +  #%>% dplyr::filter(flag =="CHN"), col = "orange")
  theme_minimal() +
  labs(title = "Global Network of Chinese Distant Water Fishing Fleets")
  
  

plot_map_CHN

ggsave(filename = "plot_map_CHN.png")


### ARG test

arg <- EEZ_final_results %>%
  dplyr::filter(flag == "ARG")

eez_filtered_ARG <- EEZ_map %>%
  dplyr::filter(ez_hs_c %in% arg$eez_iso3)

EEZ_final_results_ARG <- EEZ_final_results%>% 
  filter(flag == "ARG") 
  #filter(eez_iso3 == "USA", flag == "CHN") %>% 

plot_map_ARG <- ggplot()+
  geom_sf(data = EEZ_map, fill = "white", alpha = 0.5)+
  geom_sf(data = country_map, fill = "white")+
  geom_sf(data = country_map %>% dplyr::filter(iso3 == "ARG"), fill = "red")+ 
  geom_sf(data = eez_filtered_ARG, fill = "blue", alpha = 0.5) +
  geom_sf(data = EEZ_final_results_ARG , col = "orange") #%>% dplyr::filter(flag =="CHN"), col

plot_map_ARG

ggsave(filename = "plot_map_ARG.png")



### USA TESt

USA <- EEZ_final_results %>%
  dplyr::filter(flag == "USA")

eez_filtered_USA <- EEZ_map %>%
  dplyr::filter(ez_hs_c %in% USA$eez_iso3)

EEZ_final_results_USA <- EEZ_final_results%>% 
  filter(flag == "USA") 
  #filter(eez_iso3 == "USA", flag == "CHN") %>% 

plot_map_USA <- ggplot()+
  geom_sf(data = EEZ_map, fill = "white", alpha = 0.5)+
  geom_sf(data = country_map, fill = "white") +
  geom_sf(data = country_map %>% dplyr::filter(iso3 == "USA"), fill = "red") +
  geom_sf(data = eez_filtered_USA, fill = "blue", alpha = 0.5)+
  geom_sf(data = EEZ_final_results_USA, col = "orange" )

plot_map_USA




EEZ_map_USA <- EEZ_map %>% 
  filter(ez_hs_c == "USA")

ggsave(filename = "plot_map_USA.png")






```




## For next week
#File with all country and their EEZ
#Also number of hours, vessels, and hwhrs in Each EEZ
#try and automate script so that it can be re-run with different levels of effort
#mapping- try and do similar thing- # of countries cut off

```

